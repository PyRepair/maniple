The issue description is:

```text
tornado/demos/websocket/chatdemo.py

chat["html"] = tornado.escape.to_basestring(
            self.render_string("message.html", message=chat))
[E 170412 12:04:47 websocket:487] Uncaught exception in /chatsocket
    Traceback (most recent call last):
      File "/Users/crane/Projects/tornado/tornado/websocket.py", line 484, in _run_callback
        result = callback(*args, **kwargs)
      File "/Users/crane/Projects/tornado/demos/websocket/chatdemo.py", line 92, in on_message
        self.render_string("message.html", message=chat))
      File "/Users/crane/Projects/tornado/tornado/web.py", line 863, in render_string
        namespace = self.get_template_namespace()
      File "/Users/crane/Projects/tornado/tornado/web.py", line 887, in get_template_namespace
        namespace.update(self.ui)
    TypeError: 'NoneType' object is not iterable
```
